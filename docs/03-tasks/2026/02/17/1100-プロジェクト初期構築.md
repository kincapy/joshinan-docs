---
title: プロジェクト初期構築
status: 進行中
---

# プロジェクト初期構築

## 概要

Next.js + Prisma + Supabase のモノレポ構成でプロジェクトを構築し、Vercel にデプロイ可能な状態にする。最初の1-2カテゴリの実装で開発フローを検証し、問題なければ残りを一気に実装する。

## 技術スタック

| レイヤー | 技術 | 備考 |
|---------|------|------|
| フロントエンド + API | Next.js (App Router) | API Routes で API も統合。Vercel にデプロイ |
| ORM | Prisma | スキーマ管理・マイグレーション |
| DB | Supabase (PostgreSQL) | 無料枠内で運用 |
| 認証 | Supabase Auth | |
| UI | shadcn/ui | Next.js との相性が良い |
| ファイルストレージ | Box | 本格運用時のファイル保管先 |
| AI | Claude API | チャットボット機能 |
| モノレポ管理 | pnpm workspace | |

## 参照ドキュメント

- `docs/02-system-specification/` — 全13カテゴリのエンティティ・UIUX定義

## 確認事項

| # | 質問 | 回答 |
|---|------|------|
| 1 | モノレポ管理ツール | pnpm workspace |
| 2 | UIコンポーネントライブラリ | shadcn/ui |
| 3 | API アーキテクチャ | Next.js API Routes（Vercel Serverless）。NestJS は使わず Next.js に統合 |
| 4 | 認証方式 | Supabase Auth |
| 5 | リポジトリ構成 | 同じリポジトリ（チャットボットでのドキュメント参照を考慮） |

## 実装項目チェックリスト

### Phase 1: モノレポ・プロジェクト骨格

- [x] リポジトリ構成の作成
  ```
  apps/
    web/          — Next.js（フロント + API Routes）
  packages/
    domain/       — 共有ドメイン定義（Entity, Enum, バリデーション）
    database/     — Prisma スキーマ・マイグレーション
  docs/           — VitePress ドキュメント（既存）
  ```
- [x] pnpm workspace 設定
- [x] Next.js プロジェクトのセットアップ（apps/web）
- [x] 共有パッケージの設定（packages/domain, packages/database）
- [x] TypeScript 設定の統一（tsconfig.base.json）
- [ ] ESLint / Prettier 設定（最小限のみ。本格設定は Phase 8 以降）

### Phase 2: データベース・Prisma

- [x] Supabase プロジェクトの作成
- [x] Prisma スキーマの作成（全13カテゴリのエンティティ定義から）
  - [x] 01-school-info: SchoolInfo, EnrollmentPeriod
  - [x] 02-student-management: Student, StudentDocument, InterviewRecord
  - [x] 03-curriculum: Subject, Period, TimetableSlot
  - [x] 04-class-assignment: Class, ClassEnrollment
  - [x] 05-attendance: AttendanceRecord, MonthlyAttendanceRate, SemiannualAttendanceReport
  - [x] 06-tuition: BillingItem, Invoice, Payment, MonthlyBalance
  - [x] 07-agent-management: Agent, AgentAlias, AgentInvoice, AgentPayment
  - [x] 08-facility-management: Dormitory, DormitoryAssignment, DormitoryUtility, WifiDevice
  - [x] 09-staff-management: Staff, TeacherQualification
  - [x] 11-immigration-report: ImmigrationTask, ImmigrationDocument, ScheduledReport
  - [x] 12-internal-documents: DocumentTemplate, GeneratedDocument
  - [x] 14-recruitment: RecruitmentCycle, ApplicationCase, ApplicationDocument, DocumentCheckResult
  - [x] 15-specified-skilled-worker: JobPosting, JobMatch, SupportPlan
- [x] Enum 定義の作成
- [x] マイグレーション実行・動作確認（db push で Supabase に反映済み）

### Phase 3: API 基盤（Next.js API Routes）

- [x] API ディレクトリ構成（app/api/）
- [x] Supabase Auth 連携（ミドルウェア）
- [x] 共通レスポンス形式の定義
- [x] エラーハンドリングの共通化
- [x] バリデーション（Zod）

### Phase 4: フロントエンド基盤

- [x] Next.js のディレクトリ構成（App Router）
- [x] shadcn/ui の導入
- [x] レイアウト（サイドバー、ヘッダー）
- [x] 認証フローの実装（ログイン画面）
- [x] API クライアントの設定

### Phase 5: 検証用カテゴリ実装（01-school-info）

- [ ] API: SchoolInfo の CRUD エンドポイント
- [ ] API: EnrollmentPeriod の CRUD エンドポイント
- [ ] Web: 学校情報画面
- [ ] Web: 入学時期一覧・登録画面
- [ ] E2E動作確認

### Phase 6: 検証用カテゴリ実装（02-student-management）

- [ ] API: Student の CRUD エンドポイント
- [ ] API: 学生ステータス管理
- [ ] Web: 学生一覧画面（フィルタ・検索・ページネーション）
- [ ] Web: 学生詳細画面（タブ構成）
- [ ] Web: 学生登録画面
- [ ] E2E動作確認

### Phase 7: デプロイ

- [ ] Vercel デプロイ設定
- [ ] 環境変数の管理
- [ ] CI/CD パイプライン（GitHub Actions）
- [ ] 本番環境での動作確認

### Phase 8: 開発フロー振り返り

- [ ] Phase 5-6 の実装で判明した課題の整理
- [ ] 仕様書との乖離があれば修正
- [ ] 開発手順のドキュメント化
- [ ] 残り11カテゴリの一括実装計画の策定

## 申送事項

- ファイルストレージは本格運用時に Box を使用する方針（初期構築では未実装）
- チャットボット機能（Claude API）は基盤構築後に別タスクとして実装
- 15-specified-skilled-worker は今後 Company 系テーブルの追加予定あり
