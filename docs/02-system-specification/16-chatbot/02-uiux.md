---
title: チャットボット — UIUX定義
---

# チャットボット — UIUX定義

## 画面一覧

| # | 画面 | パス | 説明 |
|---|------|------|------|
| 1 | チャットメイン | `/chat` | チャットの対話画面 |
| 2 | セッション一覧 | `/chat`（サイドバー） | 過去の会話一覧・検索 |
| 3 | 決裁一覧 | `/chat/approvals` | 承認待ちの決裁申請一覧 |

## 画面構成

### 全体レイアウト

```
┌──────────────────────────────────────────────────────┐
│  ヘッダー（アプリ共通）                                │
├────────────┬─────────────────────────────────────────┤
│            │                                         │
│ セッション │         チャット領域                      │
│   一覧     │                                         │
│            │  ┌─────────────────────────────────┐    │
│ [+ 新規]   │  │ AI: 何かお手伝いできますか？     │    │
│            │  │                                 │    │
│ 2/17 未納者│  │ User: 出席率80%以下の子出して    │    │
│ 2/15 寮変更│  │                                 │    │
│ 2/10 入管..│  │ AI: 以下の学生が該当します。     │    │
│            │  │ ┌──────────────────────────┐    │    │
│            │  │ │ 名前  | 出席率 | クラス  │    │    │
│            │  │ │ 田中  | 72%   | A1     │    │    │
│            │  │ │ 李    | 65%   | B2     │    │    │
│            │  │ └──────────────────────────┘    │    │
│            │  │ [CSVダウンロード] [Excel]        │    │
│            │  └─────────────────────────────────┘    │
│            │                                         │
│            │  ┌─────────────────────────────────┐    │
│            │  │ 入力欄                    [送信] │    │
│            │  └─────────────────────────────────┘    │
├────────────┴─────────────────────────────────────────┤
```

## モード別 UI フロー

### モード1: ナレッジ回答

```
User: 「入管届出の期限っていつまで？」
  ↓
AI: テキストで回答
    + 該当するドキュメントへのリンクを表示
    「詳しくはこちら: 入管報告・届出 > 業務フロー」
```

- ドキュメントリンクは VitePress のページURLを表示
- 回答の根拠となる法令・条文番号があれば併記

### モード2: データ照会・出力

```
User: 「先月の学費未納者を出して」
  ↓
AI: DBを検索し、結果を表形式で表示
    ┌──────────────────────────────────────┐
    │ 名前    | 未納額   | 未納月  | クラス │
    │ 田中太郎 | ¥80,000 | 2026/1 | A1    │
    │ 李明    | ¥60,000 | 2026/1 | B2    │
    └──────────────────────────────────────┘
    [CSVダウンロード] [Excelダウンロード]
```

- データ量が多い場合はページネーションまたはスクロール表示
- ダウンロードボタンでCSV/Excel形式のファイルを取得可能
- Excelファイルはサーバー側で生成し、ダウンロードリンクを返す

### モード3: データ変更

```
User: 「田中太郎さんがX寮からY寮の201号室に引っ越した」
  ↓
AI: 変更内容を解釈し、確認画面を表示
    ┌──────────────────────────────────────┐
    │ 以下の変更を行います。               │
    │                                      │
    │ 学生: 田中太郎                        │
    │ 項目: 居住物件                        │
    │ 変更前: X寮 101号室                   │
    │ 変更後: Y寮 201号室                   │
    │                                      │
    │  [実行]  [キャンセル]                 │
    └──────────────────────────────────────┘
```

#### 不足情報がある場合

```
User: 「田中さんが引っ越した」
  ↓
AI: 「どの物件に引っ越しましたか？」
  ↓
User: 「Y寮の201」
  ↓
AI: 確認画面を表示（上記と同じ）
```

#### 決裁フロー（決裁者が設定されている場合）

```
User (管理者): 「田中さんをY寮に変更して」
  ↓
AI: 確認画面を表示
  ↓
User: [実行] をクリック
  ↓
AI: 「決裁者に承認依頼を送信しました。承認後に変更が反映されます。」
  ↓
決裁者: 決裁一覧画面で [承認] or [却下]
  ↓
承認の場合 → DB更新 + 申請者に通知
却下の場合 → 申請者に却下理由を通知
```

#### 決裁者がいない場合

```
User (管理者): [実行] をクリック
  ↓
AI: 即時DB更新
    「変更が完了しました。」
```

### モード4: ナレッジ更新

ナレッジ更新は**必ず決裁を通す**。

```
User: 「入管法の在留資格更新の申請期限が3ヶ月前から2ヶ月前に変わった」
  ↓
AI: 更新内容を解釈し、確認画面を表示
    ┌──────────────────────────────────────┐
    │ 以下のナレッジを更新します。          │
    │                                      │
    │ ファイル: 入管報告・届出/02-data.md    │
    │ 変更箇所: 更新申請の期限              │
    │ 変更前: 期限3ヶ月前までに申請         │
    │ 変更後: 期限2ヶ月前までに申請         │
    │                                      │
    │  [決裁申請]  [キャンセル]             │
    └──────────────────────────────────────┘
  ↓
User: [決裁申請] をクリック
  ↓
AI: 「決裁者に承認依頼を送信しました。」
  ↓
決裁者: 承認後 → Markdown ファイルが更新される
```

#### 回答へのフィードバック

```
AI: 「出席率50%を下回ると入管報告が必要です」
  ↓
User: 「それ古い。今は45%になった」
  ↓
AI: ナレッジ更新の確認画面を表示（上記と同じフロー）
```

## 決裁一覧画面

決裁者専用の画面。承認待ちの申請を一覧で確認し、承認/却下する。

```
┌──────────────────────────────────────────────────────┐
│  決裁一覧                                            │
├──────────────────────────────────────────────────────┤
│                                                      │
│  ● 承認待ち (3)  ○ 承認済み  ○ 却下                  │
│                                                      │
│  ┌────────────────────────────────────────────────┐  │
│  │ 2/17 14:30 | 田中 (管理者)                     │  │
│  │ 種別: データ変更                                │  │
│  │ 内容: 学生「田中太郎」の居住物件を               │  │
│  │       X寮101号室 → Y寮201号室に変更              │  │
│  │                              [承認] [却下]      │  │
│  └────────────────────────────────────────────────┘  │
│                                                      │
│  ┌────────────────────────────────────────────────┐  │
│  │ 2/17 10:00 | 佐藤 (管理者)                     │  │
│  │ 種別: ナレッジ更新                              │  │
│  │ 内容: 入管報告/02-data.md の更新申請期限を       │  │
│  │       3ヶ月前 → 2ヶ月前に変更                    │  │
│  │                              [承認] [却下]      │  │
│  └────────────────────────────────────────────────┘  │
└──────────────────────────────────────────────────────┘
```

## Tool Use で呼び出す関数カテゴリ

Claude API の Tool Use として定義する関数群。各関数の詳細は実装フェーズで定義する。

### データ照会系

| 関数カテゴリ | 対応するエンティティ | 例 |
|-------------|--------------------|----|
| 学生検索 | Student | 「出席率80%以下の学生」「2025年入学の学生一覧」 |
| 出席照会 | AttendanceRecord, MonthlyAttendanceRate | 「先月の出席率」「欠席が多い学生」 |
| 学費照会 | Invoice, Payment, MonthlyBalance | 「未納者一覧」「入金状況」 |
| エージェント照会 | Agent, AgentInvoice | 「エージェント別の学生数」 |
| 施設照会 | （施設系エンティティ） | 「空き部屋一覧」「物件の契約状況」 |
| 入管タスク照会 | ImmigrationTask | 「今月期限の届出」 |

### データ変更系

| 関数カテゴリ | 対応するエンティティ | 例 |
|-------------|--------------------|----|
| 学生情報更新 | Student | 「住所変更」「電話番号変更」 |
| 施設情報更新 | （施設系エンティティ） | 「寮の変更」「物件台帳に追加」 |
| 出席修正 | AttendanceRecord | 「出席を遅刻に修正」 |

### ファイル操作系

| 関数カテゴリ | 連携先 | 例 |
|-------------|--------|----|
| ファイルアップロード | Box API | 「契約書をアップロード」 |
| ファイル検索 | Box API | 「田中さんの在留カードを探して」 |
| Excel/CSV生成 | サーバー側で生成 | 「この表をExcelで出して」 |

### ナレッジ操作系

| 関数カテゴリ | 対象 | 例 |
|-------------|------|----|
| ナレッジ検索 | VitePress Markdown | 「入管届出のルール」 |
| ナレッジ更新 | VitePress Markdown | 「申請期限の変更を反映」 |
